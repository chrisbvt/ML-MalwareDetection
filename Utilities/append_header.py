import argparse
import csv

def main():

    parser = argparse.ArgumentParser(description="File Indexer for Blue Sentry")
    parser.add_argument("--output_file", help="File that the data is output to in csv form", required=True)
    parser.add_argument("--input_file_csv", help="Shuffled CSV File")
    parser.add_argument("--input_file_header", help="File with header to append")


    args = parser.parse_args()

    header = open(args.input_file_header).readline()

    csv_shuffled = open(args.input_file_csv, 'r+')
    csv_new = open(args.output_file, 'w+')

    csv_new.write(header)

    i = 1

    for line in csv_shuffled:
        csv_new.write(line)
        i += 1
        if i % 1000 == 0:
            print "At Index %d" % i

    csv_new.close()


if __name__ == "__main__":
    main()


